---
  - name: Update and upgrade apt packages
    apt:
      upgrade: yes
      update_cache: yes

  - name: Install wg
    apt:
      name: wireguard
      state: present

  - name: Ensure wg directory exists
    file:
      path: /etc/wireguard
      state: directory
      mode: "700"

  - name: allow wireguard input traffic
    iptables:
      chain: INPUT
      in_interface: eth0
      destination_port: "51820"
      protocol: udp
      jump: ACCEPT
